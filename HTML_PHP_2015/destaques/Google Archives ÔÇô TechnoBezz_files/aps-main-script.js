(function($){$(window).on("load scroll rating",function(){$('[data-bar="true"]').each(function(){$(this).apsAnimateBar(3000);});});$(".aps-tooltip").hover(function(){info=$(this).next(".aps-tooltip-data").html();$("body").append('<span class="aps-tooltip-display">'+info+'</span>').show(300);container=$(".aps-tooltip-display");$(document).on("mousemove",function(e){var relY=e.pageY+20,relX=e.pageX+15;container.css({"top":relY,"left":relX});});},function(){container.hide(50,function(){$(this).remove();});});$.fn.apsIsVisible=function(){var win=$(window);viewport={top:win.scrollTop(),left:win.scrollLeft()};viewport.right=viewport.left+win.width();viewport.bottom=viewport.top+win.height();if(this.is(":visible")){var bounds=this.offset();bounds.right=bounds.left+this.outerWidth();bounds.bottom=bounds.top+this.outerHeight();return(!(viewport.right<bounds.left||viewport.left>bounds.right||viewport.bottom<bounds.top||viewport.top>bounds.bottom));}}
$.fn.apsAnimateBar=function(dur){var elnum=this.find('[data-type="num"]'),elbar=this.find('[data-type="bar"]'),rating=this.data("rating"),sPoint={num:0,wid:0},ePoint={num:rating,wid:rating*10};if(elbar.apsIsVisible(true)&&!this.hasClass("aps-animated")){this.addClass("aps-animated");$(sPoint).animate(ePoint,{duration:dur,step:function(){elnum.html(Number(this.num.toFixed(1)));elbar.css("width",this.wid+"%");}});}}
$.cookie=function(key,value,options){if(arguments.length>1&&(value===null||typeof value!=="object")){options=jQuery.extend({},options);if(value===null){options.expires=-1;}if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}return(document.cookie=[encodeURIComponent(key),'=',options.raw?String(value):encodeURIComponent(String(value)),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}options=value||{};var result,decode=options.raw?function(s){return s;}:decodeURIComponent;return(result=new RegExp('(?:^|; )'+encodeURIComponent(key)+'=([^;]*)').exec(document.cookie))?decode(result[1]):null;}
$(document).on("click","a.aps-add-compare",function(e){var value=$(this).data("pid").toString(),title=$(this).data("title"),comp=$.cookie(comp_cn),comp_btn=$("a.aps-compare");if(comp){var comp_arr=comp.split("-"),found=$.inArray(value,comp_arr),comp_num=comp_arr.length+1;if(found<0){if(comp_num<4){value=comp+"-"+value;$.cookie(comp_cn,value,{expires:7,path:"/"});$("span.aps-comp-count").html("("+comp_num+")");link=comp_link+'?pos='+value;comp_btn.attr("href",link);var message=msg_suc.replace("%title%",title).replace("%link%",link);}else{link=comp_link+'?pos='+comp;var message=msg_ful.replace("%link%",link);}}else{link=comp_link+'?pos='+comp;var message=msg_dup.replace("%title%",title).replace("%link%",link)}}else{$.cookie(comp_cn,value,{expires:7,path:"/"});link=comp_link+'?pos='+value;comp_btn.attr("href",link);$("span.aps-comp-count").html("(1)");var message=msg_suc.replace("%title%",title).replace("%link%",link);}aps_response_msg("success",message,true);aps_comparison_list();e.preventDefault();});$(".aps-dropdown").hover(function(){$(this).find("ul").stop().slideDown();},function(){$(this).find("ul").stop().slideUp();});$(".aps-display-controls li a").click(function(e){var elmList=$(".aps-products"),gridClass="aps-products-grid",listClass="aps-products-list";$(".aps-display-controls li a").removeClass("selected");$(this).addClass("selected");if($(this).hasClass("aps-display-list")){elmList.removeClass(gridClass).addClass(listClass);$.cookie("aps_display","list",{expires:30,path:"/"});}else{elmList.removeClass(listClass).addClass(gridClass);$.cookie("aps_display","grid",{expires:30,path:"/"});}e.preventDefault();});$(document).on("click",".aps-remove-compare",function(){var removeBt=$(this),reload=removeBt.data("load"),pid=removeBt.data("pid").toString(),compList=$.cookie(comp_cn).split("-");compList.splice($.inArray(pid,compList),1);comp_num=compList.length;newVal=compList.join("-");$.cookie(comp_cn,newVal,{expires:7,path:"/"});if(reload==true||typeof compare_page!=="undefined"){location=comp_link+"?pos="+newVal;}else{removeBt.parent("li").fadeOut(200,function(){$(this).remove();});}if(comp_num>0){comp_num="("+comp_num+")";link=comp_link+'?pos='+newVal;}else{comp_num="";link=comp_link;}$("a.aps-compare").attr("href",link);$("span.aps-comp-count").html(comp_num);});$("[data-slider]").each(function(){$(this).after('<span class="aps-range-output"></span>');}).bind("slider:ready slider:changed",function(event,data){$(this).nextAll(".aps-range-output:first").html(data.value.toFixed(0));var totalSum=0,inputs=0;$("[data-slider]").each(function(){totalSum+=Number($(this).val());inputs++});totalRating=totalSum/inputs;$(".aps-total-score").html(totalRating);});$("#apsReviewForm").submit(function(e){var rvform=$(this),button=rvform.find(".aps-button"),rvdata=rvform.serialize();$.ajax({url:ajaxurl,type:"POST",data:rvdata,dataType:"json",beforeSend:function(){button.hide();button.after('<span class="aps-loading alignright"></span>');},success:function(res){if(res.success){aps_response_msg("success",res.success,true);rvform.trigger("reset");}else{aps_response_msg("error",res.error,true);}},complete:function(){button.next(".aps-loading").remove();button.show();}});e.preventDefault();});$(document).on("click",".aps-comps-handle",function(){if($(this).hasClass("opened")){$(this).removeClass("opened");$(this).parent().animate({"right":"-182px"},200);}else{$(this).addClass("opened");$(this).parent().animate({"right":"0"},300);}});function aps_response_msg(icn,msg,auto){if(icn=="success"){var content='<span class="aps-msg-success"><span class="aps-icon-check"></span>'+msg+'</span>';}else if(icn=="error"){var content='<span class="aps-msg-errors"><span class="aps-icon-attention"></span>'+msg+'</span>';}else{var content=msg;}$("body").append('<div class="aps-msg-overlay"></div><div class="aps-res-msg"><span class="aps-icon-cancel aps-close-box aps-close-icon"></span>'+content+'</div>');var msg_box=$(".aps-res-msg"),msg_overlay=$(".aps-msg-overlay"),box_height=msg_box.outerHeight()/2,box_width=msg_box.outerWidth()/2;msg_box.css({marginTop:"-"+box_height+"px",marginLeft:"-"+box_width+"px"});msg_overlay.fadeIn(200);msg_box.fadeIn(300);if(auto){setTimeout(remove_box,9999);}$(".aps-close-box").click(remove_box);function remove_box(){msg_box.fadeOut("slow",function(){$(this).remove();msg_overlay.fadeOut("fast",function(){$(this).remove();});});}}function aps_comparison_list(){name="aps_comp",comp=$.cookie(name),comp_btn=$("a.aps-compare");if(comp){var comp_arr=comp.split("-");if(comp_arr.length>0){if(!$(".aps-comps-overlay").length){$("body").append('<div class="aps-comps-overlay"></div>');}var cldata={action:"aps-comps",pos:comp};$.ajax({url:ajaxurl,type:"GET",data:cldata,beforeSend:function(){$(".aps-comps-overlay").animate({"right":"-182px"},200);},success:function(res){if(res){$(".aps-comps-overlay").html(res);}},complete:function(){$(".aps-comps-handle").addClass("opened");$(".aps-comps-overlay").animate({"right":"0"},300);}});}else{$(".aps-comps-overlay").fadeOut(300,function(){$(this).remove();});}}}$(window).on("load",aps_comparison_list());})(jQuery);